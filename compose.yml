services:

  backend:
    image: ajbot:3.2.0
    restart: unless-stopped
    pull_policy: never
    container_name: ajbot
    build:
      context: .
      dockerfile: Dockerfile
      target: runner
    # ports:
    #   - 8000:8000
    volumes:
      - ".env:/.env"
    depends_on:
      - ajdb

  ajdb:
    image: mongo:latest
    container_name: ajdb
    restart: unless-stopped
    # ports:
    #   - 27017:27017
    volumes:
      - ajdb-data:/data/db
    env_file:
      - ajdb.env

  ajdb-express:
    image: mongo-express:latest
    restart: unless-stopped
    ports:
      - 8081:8081
    container_name: ajdb-express
    env_file:
    - ajdb-express.env
    depends_on:
      - ajdb

volumes:
  ajdb-data: